<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title></title>

    </head>
    <body>
    	<header>
	    	Quiz Application
	    </header>
    	<section id="questions">
    	</section>
        <section id="score"></section>
    </body>
    <script>
        function init() {
        	var questions = '[{"question": "What is something?","options": ["answer1", "answer2"],"answer": ["answer2"]},{"question": "What is something2?","options": ["answer1", "answer2"],"answer": ["answer1", "answer2"]},{"question": "What is something3?","options": ["answer1", "answer2", "answer3"],"answer": ["answer2", "answer3"]}]';

    		var dataModel = JSON.parse(questions);

    		for(var i = 0; i < dataModel.length; i++) {
    			var article = document.createElement('article');

    			article.innerHTML = '<p>' + dataModel[i].question + '</p>';
                //i = current iteration index
                for(j = 0; j < dataModel[i].options.length; j++) {
                    var checkbox = document.createElement('input');

                    checkbox.setAttribute('type', 'checkbox');
                    checkbox.setAttribute('id', 'options' + i + '' + j);
                    checkbox.setAttribute('value', i + ':' + dataModel[i].options[j]);
                    checkbox.setAttribute('name', 'option' + i);

                    var label = document.createElement('label');

                    label.setAttribute('for', 'options' + i + '' + j);
                    label.innerHTML = dataModel[i].options[j];

                    var breakTag = document.createElement('br');

                    article.append(checkbox);
                    article.append(label);
                    article.append(breakTag);
                }

    			document.getElementById('questions').append(article);
    		}; 

            var button = document.createElement('button');

            button.innerHTML = 'Submit';

            button.onclick = function () {
                var checkboxElements = document.querySelectorAll('[id^=options]');
                var score = 0;
                    
                for (var i = 0; i < checkboxElements.length; i++) {
                    if (checkboxElements[i].checked) {
                        var answer = checkboxElements[i].value.split(':');
                        var correctAnswer = dataModel[answer[0]].answer.filter(function(data) {
                            return  data === answer[1];
                        });

                        if (correctAnswer.length >= 1) {
                            score++;
                        } 
                    }
                }

                showResults(score);
            }

            var breakTag = document.createElement('br');

        	document.getElementById('questions').append(breakTag);
            document.getElementById('questions').append(button);
        }

        function showResults(score) {
                var scoreSection = document.getElementById('score');
                var article = document.createElement('article');

                article.innerHTML = "<p> Your score is <b>" + score + "</b></p";
                scoreSection.append(article);
        }

        window.onload = init;
    </script>
</html>